
<div class="header">
    <a class="option pull-left plm" ng-click="goBack()"><i class="icon-chevron-left icon-large"></i></a>
    <span>{{e.title}}</span>
    <a class="option pull-right prm" ng-click="onEdit()"><i class="icon-edit icon-large"></i></a>
</div>

<div class="container">
    <div class="itemdetail-thumb">
        <div class="item-thumbnail">
            <img ng-src="{{meta.imgbase}}{{e.image.thumbnail2}}"/>
        </div>
        <div class="itemdetail-info">
            <span>活动类型：{{e.ca}}</span><br>
            <span>活动状态：{{status[e.status+1]}}</span><br>
            <span>开始时间：{{e.start_time| date:'MM月dd日 HH:mm'}}</span><br>
            <span>结束时间：{{e.end_time| date:'MM月dd日 HH:mm'}}</span><br>
            <span>活动地点：{{e.avenue}}</span><br>
            <span>发起人　：{{e.starter.name}}</span>
        </div>
    </div>

    <div class="itemdetail-option">
        <a class="btn btn-primary itemdetail-btn" ng-click="onEdit()" ng-show="IamOwner">修改活动</a>
        <a class="btn btn-primary itemdetail-btn" ng-click="onRegister()" ng-init="text=['马上报名','取消报名']" ng-hide="IamOwner">
            {{text[IamIn]}}</a>
        <a class="btn btn-info itemdetail-btn" ng-click="onShare()">分享活动</a>
        <a class="btn btn-inverse itemdetail-btn" ng-click="onUpload()">上传照片</a>
    </div>

    <div class="itemdetail-misc" ng-init="select=0">
        <div ihtabs="select" ihtabs-padding=20 class="tabs-navs">
            <span ng-click="select=0" ng-class="{active: select==0}">活动简介</span>
            <span ng-click="select=1" ng-class="{active: select==1}">活动讨论</span>
            <span ng-click="select=2"  ng-class="{active: select==2}">活动照片</span>
        </div>

        <div ihtabs-bar="blue" class="tabs-bar"></div>

        <div ihshift="select" ihshift-margin=40 class="tabs-content">
            <div ng-iscroll='e.attendees' class="tabs-pane">
                <div>
                    <div style="white-space:pre-wrap;padding-top: 5px">{{e.description}}</div>
                    <hr>
                    <p>参与名单<span><small>({{e.attendees.length}}):</small></span></p>
                    <a ng-repeat="u in e.attendees">
                        <img class="user-thumbnail" style="vertical-align: middle" ng-src={{u.profile_image_url}} />
                        <span>{{u.name}}</span>
                    </a>
                </div>
            </div>

            <div ng-iscroll='e.comment_set' iscroll-form class="tabs-pane" ng-controller='CommentCtrl'>
                <div class="comment-content">
                    <div ng-iscroll-pull="{statusID: 'pullStatus', onLoad: onRefresh}" class="pull pullDown">
                        <span class="pullIcon pullDown" ng-class="{flip:pullStatus=='flip',loading:pullStatus=='loading'}"></span>
                        <span ng-init="pullStatus='idle'; pullText={idle:'下拉可以刷新...', flip:'松开即可刷新...', loading:'加载中...'}">{{pullText[pullStatus]}}</span>
                    </div>
                    <div ng-repeat="c in e.comment_set">
                        <div class="pvs clearfix">
                            <div class="user-thumbnail pull-left prm">
                                <img  ng-src={{c.author.profile_image_url}} />
                            </div>
                            <div >
                                <div>
                                    <span>{{c.author.name}} : </span>
                                    <span>{{c.body}}</span>
                                </div>
                                <div>
                                    <span><small>{{c.created | date:'MM月dd日 HH:mm'}}</small></span>
                                    <span class="pull-right" ng-show="meta.user.id===c.author.id">
                                        <a ng-click="onCommentDel(c.id)"><i class="icon-trash"></i></a>
                                     </span>
                                </div>
                            </div>
                        </div>
                        <hr>
                    </div>
                    <div ng-iscroll-more="{statusID: 'moreStatus', onLoad: onMore}" class="pull pullUp">
                        <span class="pullIcon pullUp" ng-class="{loading:moreStatus=='loading'}"></span>
                        <span ng-bind="moreText[moreStatus]" ng-init="moreText={idle:'加载更多...',loading:'加载中...'};moreStatus='init'"></span>
                    </div>
                </div>
                <div class="comment-form">
                    <input class="pull-left" ng-model="comment" type="text" ifill-left>
                    <a class="btn btn-primary pull-right" ng-click="onComment()">发布</a>
                </div>
            </div>

            <div ng-iscroll='e.album' class="tabs-pane">
                <div >
                    <div ng-repeat="img in e.album" class="img-thumbnail pull-left">
                        <img ng-src="{{meta.imgbase}}{{img.thumbnail2}}">
                    </div>
                </div>
            </div>
        </div>
    </div>



</div>


